<app-main-toolbar back="/settings/imexport">{{'page_settings_import.page_title'|translate}}</app-main-toolbar>

<ion-content class="page">
    <div class="container" *ngIf="!ImportDone; else done">
        <div class="content">
            <ion-icon src="/assets/icons/import.svg" class="icon"></ion-icon>

            <div class="select-archive" *ngIf="!Archive?.length || !ArchiveValid">
                <div class="text" [innerHTML]="'page_settings_import.select_archive' | translate"></div>
                <ion-button (click)="selectArchive()">{{'page_settings_import.btn_select_archive'|translate}}</ion-button>

                <div class="text error" [innerHTML]="'page_settings_import.archive_invalid'|translate" *ngIf="ArchiveValid === false"></div>
            </div>

            <div class="select-items" *ngIf="Archive?.length && ArchiveValid && !Importer?.isRunning">
                <div class="text" [innerHTML]="'page_settings_import.select_items' | translate"></div>
                <ion-card>
                    <ion-list>
                        <ion-item lines="full" [ngClass]="['import-item', item.status]" (click)="onChangeImportItem(item)" *ngFor="let item of ImportItems">
                            <ion-icon slot="start" [src]="item.icon"></ion-icon>
                            <ion-label>
                                <ion-text class="import-item-title">{{item.locale|translate}}</ion-text>
                            </ion-label>
                            <div slot="end">
                                <ion-checkbox [checked]="item.status != 'disabled'"></ion-checkbox>
                            </div>
                        </ion-item>
                    </ion-list>
                </ion-card>
                <div class="buttons">
                    <ion-button color="secondary" (click)="selectArchive()">{{'page_settings_import.btn_reset_archive'|translate}}</ion-button>
                </div>
            </div>

            <div class="running" *ngIf="Archive?.length && ArchiveValid && Importer?.isRunning">
                <ion-card>
                    <ion-list>
                        <ion-item lines="full" [ngClass]="['import-item', item.status]" *ngFor="let item of ImportItems">
                            <ion-icon slot="start" [src]="'/assets/icons/im-export/item_'+item.status+'.svg'"></ion-icon>
                            <ion-label>
                                <ion-text class="import-item-title">{{item.locale|translate}}</ion-text>
                                <ion-progress-bar [value]="item.done"></ion-progress-bar>
                            </ion-label>
                        </ion-item>
                    </ion-list>
                </ion-card>
                <div class="buttons" *ngIf="ImportError">
                    <ion-button color="secondary" (click)="selectArchive()">{{'page_settings_import.btn_reset_archive'|translate}}</ion-button>
                </div>
            </div>
        </div>
        <ion-buttons class="fixed-bottom">
            <ion-button fill="outline" color="secondary" (click)="back()"> {{'back'|translate}} </ion-button>
            <ion-button fill="solid" color="secondary" [disabled]="!Archive?.length || !SomethingEnabled || ImportError || Importer?.isRunning" (click)="Import()"> {{'page_settings_import.btn_import'|translate}} </ion-button>
        </ion-buttons>
    </div>
</ion-content>

<ng-template #done>
    <div class="container done">
        <ion-icon src="/assets/icons/done.svg"></ion-icon>
        <div class="content">
            <div class="text" [innerHTML]="'page_settings_import.import_success' | translate"></div>
        </div>
        <ion-buttons class="fixed-bottom">
            <ion-button fill="solid" color="secondary" (click)="importDone()">{{ 'done' | translate }}</ion-button>
        </ion-buttons>
    </div>
</ng-template>
